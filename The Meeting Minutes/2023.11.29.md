# 2023.11.29

## <Collaborative work>

### ğŸŒŸCollaborative

## <Personal Work>

### â›„Nayeon

- Ensemble Kernel Update
    
    ì½”ë“œ í™•ì¸ì€ Ensemble-Kernel repositories 
    
    - Gloabl Kernel Matrix ë¬¸ë²•í™” ê³ ë¯¼í•˜ê¸°
        
        ```python
        #clinical_global.ipynbì—ì„œ í™•ì¸ ê°€ëŠ¥
        def c_o1(x1, x2, x3):
            x_matrix = np.eye(N=len(x2), M=len(x1))
            d = np.max(x3) - np.min(x3)
        
            for i in range(len(x2)):
                for j in range(len(x1)):
                    x_matrix[i,j] = (d-np.abs(x2.iloc[i]-x1.iloc[j]))/d
            return x_matrix
        
        def nom(x1, x2):
            x_matrix = np.eye(N=len(x2), M=len(x1))
            for i in range(len(x2)):
                for j in range(len(x1)):
                    if x2.iloc[i] == x1.iloc[j]:
                        x_matrix[i,j] = 1
                    else:
                        x_matrix[i,j] = 0
            return x_matrix
        
        #AFT example
        coef = (((np.abs(aft_model.summary['coef'])).drop(['sigma_'], axis=0, level=0)).drop(['Intercept'],axis=0,level=1)).droplevel(axis=0,level=0)
        
        x_1 = x_train_all.loc[[15, 42, 49]]
        
        remaining_variables = x_1.columns.tolist()
            
        x_1 = x_1[remaining_variables]
        
        nominal_columns = x_1.select_dtypes(include=['object', 'category', 'bool']).columns
        continuous_columns = x_1.drop(nominal_columns, axis=1).columns
        
        sum_matrix = sum(coef[i] * (c_o1(x_1[i], x_1[i], x_train1[i]) if i in continuous_columns else nom(x_1[i], x_1[i])) for i in x_1)
        
        # ensemble
        mat = sum_matrix / sum(coef[i] for i in x_1)
        
        #ë¬¸ë²•í™” ì§„í–‰ ê³ ë¯¼í•  ê²ƒ
        ```
        

### ğŸ’ªğŸ»Beomseok

- Kernel-Function Update
    
    ì½”ë“œ í™•ì¸ì€ Ensemble-Kernel repositories 
    
    - Library import ìˆ˜ì •í•˜ê¸°
        
        ```python
        #ê¸°ì¡´ library import code
        import numpy as np
        import pandas as pd
        from lifelines import KaplanMeierFitter, CoxPHFitter
        from lifelines import LogNormalAFTFitter
        from lifelines import WeibullAFTFitter
        from lifelines import LogLogisticAFTFitter
        import matplotlib.pyplot as plt
        from sklearn.model_selection import train_test_split
        import seaborn as sns
        from sklearn import set_config
        from sklearn.model_selection import ShuffleSplit, GridSearchCV
        from sklearn.model_selection import StratifiedKFold
        
        from sksurv.column import encode_categorical
        from sksurv.metrics import concordance_index_censored
        from sksurv.svm import FastSurvivalSVM, FastKernelSurvivalSVM
        from sksurv.kernels import clinical_kernel
        from sklearn import metrics
        
        from sklearn.model_selection import KFold
        from sklearn.metrics import make_scorer
        from statsmodels.stats.outliers_influence import variance_inflation_factor
        
        import copy
        import time
        import json
        from skopt import BayesSearchCV
        
        #í˜„ì¬ library import code
        import numpy as np
        import pandas as pd
        from lifelines import CoxPHFitter, LogNormalAFTFitter, WeibullAFTFitter, LogLogisticAFTFitter
        from lifelines import LogNormalFitter, WeibullFitter, LogLogisticFitter
        
        from sklearn.model_selection import train_test_split
        from sklearn.model_selection import GridSearchCV
        
        from sksurv.metrics import concordance_index_censored
        from sksurv.svm import FastKernelSurvivalSVM
        from sksurv.kernels import clinical_kernel
        ```
        
    - Result import ìˆ˜ì •í•˜ê¸°
        ```python
        #ê¸°ì¡´ result í™•ì¸ code
        import copy

        import numpy as np
        import pandas as pd
        from itertools import combinations

        from sklearn.model_selection import KFold
        from skopt.space import Real, Categorical, Integer

        import sys
        sys.path.append('G:\ë‚´ ë“œë¼ì´ë¸Œ\ëŒ€í•™\ëŒ€ì™¸\2023\ì—°êµ¬ì›\ì—°êµ¬ê³¼ì œ\Ensemble-Kernel')

        from Ensemble_Kernel_New import split_data,prepare_response_variable, c_o, nom, new_kernel, one_hot_encode_columns, convert_categorical_to_boolean, compare_kernels_with_abs_and_no_abs, train_predict_fastKernelSurvivalSVM, train_predict_fastKernelSurvivalSVM_AFT, new_kernel_AFT, train_predict_fastKernelSurvivalSVM_clinical, C_index_fastKernelSurvivalSVM
        from sksurv.kernels import clinical_kernel

        from sksurv.metrics import concordance_index_censored
        from sksurv.svm import FastSurvivalSVM, FastKernelSurvivalSVM
        from sklearn.model_selection import ShuffleSplit, GridSearchCV

        #í˜„ì¬ result í™•ì¸ code
        import copy

        import numpy as np
        import pandas as pd
        from itertools import combinations

        from sklearn.model_selection import KFold
        from skopt.space import Real

        import sys
        sys.path.append('G:\ë‚´ ë“œë¼ì´ë¸Œ\ëŒ€í•™\ëŒ€ì™¸\2023\ì—°êµ¬ì›\ì—°êµ¬ê³¼ì œ\Ensemble-Kernel')

        from kernel_function import split_data, prepare_response_variable, c_index_kernel_type
        ```