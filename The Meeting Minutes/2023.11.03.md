# 2023.11.03

## <Collaborative Work>

### ğŸŒŸCollaborative

ê¸°ì¡´ ë°©ë²•

- train, test splitì„ 100ë²ˆ ë°˜ë³µ
- ìµœì¢… ê²°ê³¼ëŠ” ì•ì„œ ë‚˜ì˜¨ ê²°ê³¼ 100ê°œì˜ meanìœ¼ë¡œ í‘œì‹œ

ìƒˆë¡œìš´ ë°©ë²•

- splitëœ train, test dataì—ì„œ train dataë¥¼ cross validationì§„í–‰
    - train dataë¥¼ 5ë“±ë¶„ í•˜ì—¬ ê·¸ì¤‘ 4ê°œë¡œ model select, ë‚˜ë¨¸ì§€ 1ê°œë¡œ validation data
    - ì´ë•Œ 5ë“±ë¶„ ê°ê° í•œë²ˆì”© validation dataë¡œ ì‚¬ìš©í•´ì„œ ë‹¤ì„¯ë²ˆ ì§„í–‰
    - ë‹¤ì„¯ë²ˆ ì§„í–‰í•œ ê²°ê³¼ë¥¼ í‰ê· ë‚´ì„œ best c-index ì¶”ì¶œ
    
    ```python
    # Create kernel using x_train
    train_kernel, coef, coef_drop, remaining_variables = new_kernel(x_train, drop=False, keywords = ['Age','Sex'])
    
    # Grid Optimization
    kssvm = FastKernelSurvivalSVM(optimizer = "rbtree", kernel = 'precomputed', max_iter = 1000, tol = 1e-6, random_state=36)
    kgcv = GridSearchCV(kssvm, param_grid, n_jobs=-1, refit=True, cv=KFold(n_splits = 5, shuffle=True, random_state=36))
    
    # Fit model
    kgcv.fit(train_kernel, y_train)
    
    # Optimal hyperparameters and c_index
    best_params = kgcv.best_params_
    best_c_index = kgcv.best_score_
    
    # Predict on x_train and calculate c_index
    train_pred = kgcv.predict(train_kernel)
    train_c_index = concordance_index_censored(y_train["Status"], y_train["OS"], train_pred)
    
    # Predict on x_test and calculate c_index
    test_kernel, _, _, _ = new_kernel(x_train, x_test, coef=coef, drop=False, coef_drop=coef_drop, keywords=['Age', 'Sex'])
    test_pred = kgcv.predict(test_kernel)
    test_c_index = concordance_index_censored(y_test["Status"], y_test["OS"], test_pred)
    ```
    
    ìœ„ì˜ ì½”ë“œë¥¼ ë‹¤ì„¯ë²ˆ ì§„í–‰í•˜ê²Œ ë˜ëŠ”ë°, ì´ë•Œ x_trainì— train dataì¤‘ 5ë¶„ì˜ 4ë¥¼ ëŒ€ì…í•˜ê³ , x_testì— validation dataë¥¼ ëŒ€ì…
    
- ë³€ìˆ˜ë¥¼ 1ê°œë¶€í„° ì „ì²´ ë‹¤ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ëª¨ë‘ í™•ì¸
    - ì˜ˆë¥¼ë“¤ì–´ ë³€ìˆ˜ pê°€ 13ê°œì˜ ê²½ìš°, p=1~13ê¹Œì§€ ëª¨ë‘ ì§„í–‰
    - p=1ì€ ë³€ìˆ˜ê°€ 1ê°œì¸ ê²½ìš°, ì¦‰ 13ë²ˆ ì§„í–‰í•˜ê²Œ ë¨
    - ì´ë•Œ ê°€ì¥ best c-indexë¥¼ ì°¾ê³  ê·¸ë•Œì˜ ë³€ìˆ˜ë¥¼ í™•ì¸
- ìœ„ì˜ ê³¼ì •ì„ 100ë²ˆ ë°˜ë³µ í›„ c-indexì˜ í‰ê·  í™•ì¸